/* ---------------------------------------------------- */
/*  Generated by Enterprise Architect Version 13.5 		*/
/*  Created On : 24-oct.-2022 3:11:32 p. m. 				*/
/*  DBMS       : Oracle 						*/
/* ---------------------------------------------------- */

/* Drop Triggers, Sequences for Autonumber Columns */

DECLARE 
  C NUMBER; 
BEGIN 
SELECT COUNT(*) INTO C 
FROM ALL_TRIGGERS 
  WHERE OWNER = '' 
  AND TRIGGER_NAME = 'TRG_USERS_ACTIVATIONS_USAC_ID'; 
  IF (C > 0) THEN 
    EXECUTE IMMEDIATE 'DROP TRIGGER "TRG_USERS_ACTIVATIONS_USAC_ID"'; 
END IF; 
END; 

;

DECLARE 
  C NUMBER; 
BEGIN 
SELECT COUNT(*) INTO C 
FROM ALL_SEQUENCES 
  WHERE SEQUENCE_OWNER = '' 
  AND SEQUENCE_NAME = 'SEQ_USERS_ACTIVATIONS_USAC_ID'; 
  IF (C > 0) THEN 
    EXECUTE IMMEDIATE 'DROP SEQUENCE "SEQ_USERS_ACTIVATIONS_USAC_ID"'; 
END IF; 
END; 

;

/* Drop Tables */

begin
	EXECUTE IMMEDIATE 'DROP TABLE   "USERS_ACTIVATIONS" CASCADE CONSTRAINTS';
	EXCEPTION WHEN OTHERS THEN NULL;
end;  
/

/* Create Tables */

CREATE TABLE  "USERS_ACTIVATIONS"
(
	"USAC_ID" NUMBER(8) NOT NULL,
	"LAST_LOGIN" TIMESTAMP(6) NOT NULL,
	"USER_ID" NUMBER(8) NOT NULL,
	"IS_ACTIVE" NUMBER(1) NOT NULL
)
TABLESPACE	HTRC_TBS03
;

/* Create Comments, Sequences and Triggers for Autonumber Columns */

COMMENT ON TABLE  "USERS_ACTIVATIONS" IS 'Table containing  activation data associated with users.'
;

CREATE SEQUENCE "SEQ_USERS_ACTIVATIONS_USAC_ID" 
	INCREMENT BY 1 
	START WITH 1 
	NOMAXVALUE 
	MINVALUE  1 
	NOCYCLE 
	NOCACHE 
	NOORDER
;

CREATE OR REPLACE TRIGGER "TRG_USERS_ACTIVATIONS_USAC_ID" 
	BEFORE INSERT 
	ON "USERS_ACTIVATIONS" 
	FOR EACH ROW 
	BEGIN 
		SELECT "SEQ_USERS_ACTIVATIONS_USAC_ID".NEXTVAL 
		INTO :NEW."USAC_ID" 
		FROM DUAL; 
	END;
;
/


/* Create Primary Keys, Indexes, Uniques, Checks, Triggers */

ALTER TABLE  "USERS_ACTIVATIONS" 
 ADD CONSTRAINT "PK_USERS_ACTIVATIONS"
	PRIMARY KEY ("USAC_ID") 
 USING INDEX
;

CREATE INDEX "IXFK_USERS_ACTIVATIONS_USERS"   
 ON  "USERS_ACTIVATIONS" ("USER_ID") 
;

/* Create Foreign Key Constraints */

ALTER TABLE  "USERS_ACTIVATIONS" 
 ADD CONSTRAINT "FK_USERS_ACTIVATIONS_USERS"
	FOREIGN KEY ("USER_ID") REFERENCES  "USERS" ("USER_ID")
;
